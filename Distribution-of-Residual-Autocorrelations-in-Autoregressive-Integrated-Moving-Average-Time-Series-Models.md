# Distribution of Residual Autocorrelations in Autoregressive Integrated Moving Average Time Series Models

多くの統計モデル、特にARMAモデルは、データをホワイト・ノイズ、つまり無相関の誤差列に変換する手段とみなすことができる。

「残渣」とは、モデルパラメータの推定量と観測系列を用いたある時刻の予測値とその実現値の差分である。

なんか、注意しないとモデルの適合度をチェックする際、'不適合'を見逃す可能性があるらしい。

特にARMAモデルはあまりにもリッチなモデルなので、大抵の時系列を網羅してしまう。よって以下の戦略が取られる。
1. process of identificationというのが使われるらしい。「もっと簡単なモデルで確率過程を表現できないのか」を調べる方法？
2. 「もっと簡単なモデル」って言ってもちゃんと統計モデルだよ
3. 適合性を診断する実験

3.の「適合性を診断」の目的は単に適合性の欠如の証拠があるかどうかを判断するだけではなく、必要な場合にモデルを修正する方法を提案することである。

1. パラメータ過多(overparameterize)のチェック
2. 残渣のテスト

1.の方法は、代替の恐れのあるモデルの性質がわかっている場合に最も有用である。残念ながら、この情報は常に利用できるとは限らず、より強力ではないが、特定のモデルが間違っている可能性がある方法を示すために、より一般的なテクニックが必要とされる。ARMAモデルの係数を推定し、その予測残差の確率的特性を考慮するのは自然なことである。もっと言うと自己相関関数ね。

${\bf a}=\{a_1,\cdots,a_n\}$は残渣系列。$a$のラグ$k$の標本自己相関を$r_k$とする。（$k<n$)<br>
${\bf r}=\{r_1,\cdots,r_n\}$は多変量正規分布。($n$が大きければ。)
$$
{\bf r}\sim\mathcal{N}({\boldsymbol\mu},\Sigma)
$$
$$
Var[r_k]=\frac{n-k}{n(n+2)}\ \ (定数)
$$
この時、残渣系列の長さ$n$が十分に大きければ、モデルが適合してる時に
$$
n(n+2)\sum_{k=1}^m\frac{r_k^2}{n-k}\sim\chi_m^2
$$
となる。



## Conclusion
近似的に、移動平均または混合自己回帰移動平均過程からの残差が、適切に選択された自己回帰過程からの残差と同じになることを上で示した。我々は、経験的計算によって、この近似の妥当性をさらに確認した。このことから，これら2つのクラスの過程を別々に考慮する必要がないことがわかる．
1. ARIMAモデルの残渣の分散共分散行列は、対応するARモデルの分散共分散行列と一致する。
2. 自己回帰モデルについてセクション4で議論した適合性の検定と診断チェックにおける残差自己相関の使用に関するすべての考慮事項は、したがって、移動平均モデルとの混合モデル（つまりARMA）にも等しく適用される。
3. つまり、"portmanteau" testとは、ARIMAモデルの適合度検定のことで、以下が検定統計量とその分布となる。
$$
n\sum_{k=1}^m\hat r_k^2\sim\chi_{\nu}^2\ \ (\nu=m-p-q)
$$

https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%A5%E3%83%B3%E3%82%B0%E3%83%BB%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E6%A4%9C%E5%AE%9A
は
$$
n(n+2)\sum_{k=1}^m\frac{r_k^2}{n-k}\sim\chi_m^2
$$
これらしい。

https://www-cc.gakushuin.ac.jp/~20130021/ecmr/chap4.pdf
ここにもちょっと載ってる。